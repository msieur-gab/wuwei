<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Rate Simulator</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 1px solid #000;
            margin: 20px 0;
        }
        #controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>
<body>
    <h1>Heart Rate Simulator</h1>
    <canvas id="heartRateCanvas" width="400" height="400"></canvas>
    <div id="controls">
        <div>
            <label for="bpmInput">BPM:</label>
            <input type="number" id="bpmInput" min="20" max="200" value="60">
        </div>
        <input type="range" id="bpmSlider" min="20" max="200" value="60">
        <button id="toggleButton">Start</button>
    </div>

    <script>
const canvas = document.getElementById('heartRateCanvas');
const ctx = canvas.getContext('2d');
const bpmInput = document.getElementById('bpmInput');
const bpmSlider = document.getElementById('bpmSlider');
const toggleButton = document.getElementById('toggleButton');

let isRunning = false;
let animationId = null;
let startTime = 0;

function updateColor(timestamp) {
    if (!startTime) startTime = timestamp;
    const elapsed = timestamp - startTime;
    
    const bpm = parseInt(bpmInput.value);
    const secondsPerBeat = 60 / bpm;
    const phase = (elapsed / 1000) % secondsPerBeat / secondsPerBeat;

    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Create base dark red background
    ctx.fillStyle = 'rgb(120, 0, 0)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Calculate arc center position
    const centerX = -50 + Math.sin(phase * Math.PI * 2) * 20;
    const centerY = -50 + Math.cos(phase * Math.PI * 2) * 20;

    // Create gradient for the subtle arc
    const gradient = ctx.createRadialGradient(
        centerX, centerY, 0,
        centerX, centerY, canvas.width
    );

    // Interpolate between dark red and light orange
    const intensity = Math.sin(phase * Math.PI * 2) * 0.5 + 0.5;
    const innerRed = Math.floor(180 + intensity * 75);  // 180 to 255
    const innerGreen = Math.floor(50 + intensity * 100); // 50 to 150
    const innerBlue = Math.floor(intensity * 30);       // 0 to 30

    gradient.addColorStop(0, `rgb(${innerRed}, ${innerGreen}, ${innerBlue})`);
    gradient.addColorStop(0.3, `rgba(${innerRed}, ${innerGreen}, ${innerBlue}, 0.5)`);
    gradient.addColorStop(1, 'rgba(120, 0, 0, 0)');

    // Draw the subtle arc
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(canvas.width, 0);
    ctx.lineTo(canvas.width, canvas.height);
    ctx.lineTo(0, canvas.height);
    ctx.closePath();
    ctx.fillStyle = gradient;
    ctx.fill();

    if (isRunning) {
        animationId = requestAnimationFrame(updateColor);
    }
}



function toggleSimulation() {
    isRunning = !isRunning;
    if (isRunning) {
        toggleButton.textContent = 'Stop';
        startTime = 0;
        animationId = requestAnimationFrame(updateColor);
    } else {
        toggleButton.textContent = 'Start';
        cancelAnimationFrame(animationId);
    }
}

bpmInput.addEventListener('input', function() {
    bpmSlider.value = this.value;
    if (isRunning) {
        startTime = 0; // Reset the animation phase when BPM changes
    }
});

bpmSlider.addEventListener('input', function() {
    bpmInput.value = this.value;
    if (isRunning) {
        startTime = 0; // Reset the animation phase when BPM changes
    }
});

toggleButton.addEventListener('click', toggleSimulation);

// Initial color
ctx.fillStyle = 'rgb(180, 0, 0)';
ctx.fillRect(0, 0, canvas.width, canvas.height);
    </script>
</body>
</html>
